<!DOCTYPE html>
<html lang="en">

<head>
	<!-- Generated by GameMaker:Studio http://www.yoyogames.com/gamemaker/studio -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta http-equiv="pragma" content="no-cache" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
	<meta charset="utf-8"/>

	<!-- Set the title bar of the page -->
	<title>My Drive - Google Drive</title>

	<!-- Set the background colour of the document -->
	<style>
		body {
			background: white;
			color: #cccccc;
			margin: 0px;
			padding: 0px;
			border: 0px;
		}

		canvas {
			image-rendering: optimizeSpeed;
			-webkit-interpolation-mode: nearest-neighbor;
			-ms-touch-action: none;
			margin: 0px;
			padding: 0px;
			border: 0px;

		}

		:-webkit-full-screen #canvas {
			width: 100%;
			height: 100%;
		}

		div.gm4html5_div_class {
			margin: 0px;
			padding: 0px;
			border: 0px;
		}

		/* START - Login Dialog Box */
		div.gm4html5_login {
			padding: 20px;
			position: absolute;
			border: solid 2px #000000;
			background-color: #404040;
			color: #00ff00;
			border-radius: 15px;
			box-shadow: #101010 20px 20px 40px;
		}

		div.gm4html5_cancel_button {
			float: right;
		}

		div.gm4html5_login_button {
			float: left;
		}

		div.gm4html5_login_header {
			text-align: center;
		}

		/* END - Login Dialog Box */
		:-webkit-full-screen {
			width: 100%;
			height: 100%;
		}
	</style>
</head>

<body id="ancss">
	<div class="gm4html5_div_class" id="gm4html5_div_id">
		<img src="./splash.png" id="GM4HTML5_loadingscreen" alt="GameMaker:HTML5 loading screen" style="display:none;"/>
			<!-- Create the canvas element the game draws to -->
			<canvas class="canvas" id="canvas" width="960" height="540" >
			 <p>Your browser doesn't support HTML5 canvas.</p>
			</canvas>
		</div>

        <!-- Run the game code -->
        <script type="text/javascript" src="./script.js"></script>
        <script>window.onload = GameMaker_Init;</script>
        <script>
			(function() {
			  var externallyFramed = false;
			  try {
				externallyFramed = top.location.host != location.host;
			  }
			  catch(err) {
				externallyFramed = true;
			  }
			  if(externallyFramed) {
				var ancss = document.getElementById("ancss");
				ancss.parentNode.removeChild(ancss);
			  }
			})();
		  </script>
		  <script>
			  function fallbackCopyTextToClipboard(text) {
					var textArea = document.createElement("textarea");
					textArea.value = text;
					
					// Avoid scrolling to bottom
					textArea.style.top = "0";
					textArea.style.left = "0";
					textArea.style.position = "fixed";

					document.body.appendChild(textArea);
					textArea.focus();
					textArea.select();

					try {
						var successful = document.execCommand('copy');
						var msg = successful ? 'successful' : 'unsuccessful';
						console.log('Fallback: Copying text command was ' + msg);
					} catch (err) {
						console.error('Fallback: Oops, unable to copy', err);
					}

					document.body.removeChild(textArea);
					}
					function copyTextToClipboard(text) {
					if (!navigator.clipboard) {
						fallbackCopyTextToClipboard(text);
						return;
					}
					navigator.clipboard.writeText(text).then(function() {
						console.log('Async: Copying to clipboard was successful!');
					}, function(err) {
						console.error('Async: Could not copy text: ', err);
					});
					}
			function download(filename, text) {
				var element = document.createElement('a');
				element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
				element.setAttribute('download', filename);

				element.style.display = 'none';
				document.body.appendChild(element);

				element.click();

				document.body.removeChild(element);
			
			}
			const button = document.body.appendChild(document.createElement('button'));
			button.innerHTML = 'download save';
			button.addEventListener('click', () => download('retrobowlsave', localStorage.getItem('MadeinGameMakerStudio2.0.savedata.ini')));
			const but = document.body.appendChild(document.createElement('button'));
			but.innerHTML = 'copy save';
			but.addEventListener('click', () => copyTextToClipboard(localStorage.getItem('MadeinGameMakerStudio2.0.savedata.ini')));
			const btn = document.body.appendChild(document.createElement('button'));
			btn.innerHTML = 'upload save';

			btn.addEventListener('click', async () => {
				let contents;
				if (!confirm('Are you sure? This will reload your page.')) return false;
				[fileHandle] = await window.showOpenFilePicker();
				const file = await fileHandle.getFile();
				contents = await file.text();
				localStorage.setItem('MadeinGameMakerStudio2.0.savedata.ini', contents);
				location.reload();
				history.go(0);
			});
			function touchHandler(event){
				var touches = event.changedTouches,
					first = touches[0],
					type = "";
				switch(event.type)
				{
					case "touchstart": type = "mousedown"; break;
					case "touchmove":  type = "mousemove"; break;        
					case "touchend":   type = "mouseup";   break;
					default:           return;
				}

				// initMouseEvent(type, canBubble, cancelable, view, clickCount, 
				//                screenX, screenY, clientX, clientY, ctrlKey, 
				//                altKey, shiftKey, metaKey, button, relatedTarget);

				var simulatedEvent = document.createEvent("MouseEvent");
				simulatedEvent.initMouseEvent(type, true, true, window, 1, 
											first.screenX, first.screenY, 
											first.clientX, first.clientY, false, 
											false, false, false, 0/*left*/, null);

				first.target.dispatchEvent(simulatedEvent);
				event.preventDefault();
			}

			function init() 
			{
				document.addEventListener("touchstart", touchHandler, true);
				document.addEventListener("touchmove", touchHandler, true);
				document.addEventListener("touchend", touchHandler, true);
				document.addEventListener("touchcancel", touchHandler, true);    
			}
			//init();
		  </script>
    </body>
</html>